## Bypassing two-factor authentication
If the user is first prompted to enter a password, and hten to enter a verification code on a separate page the user is effectively in a 'logged in' sstate before they have entered the verifiction code.
In this case it is worth testing to see if you can directly skip to 'loggen-in only' pages after completing the first authenticaion step.

## Flawed two-factor verification logic
Sometimes flawed logic in two-factor authentication means that after a user has completed the initial login step, the website doesn't adequately verify taht the sam user is completing the second step.

Example:
The user logs in with their normal credentials in the first step as follows:
```txt
POST /login-steps/first HTTP/1.1 
Host: vulnerable-website.com 
... 
username=carlos&password=qwerty
```

They are then assigned a cookie that relates to their account, and then taken to the second step of the login process
```txt
HTTP/1.1 200 OK 
Set-Cookie: account=carlos 

GET /login-steps/second HTTP/1.1 
Cookie: account=carlos
```

When submitting the verification code, the request uses this cookie to determine which account the user is trying to access
```txt
POST /login-steps/second HTTP/1.1 
Host: vulnerable-website.com 
Cookie: account=carlos 
... 

verification-code=123456
```

In this case, an attacker could log in using their own redentials but then change the value of the 'account' [[Cookies]] to any arbitrary username when submitting the verification code.
```txt
POST /login-steps/second 
HTTP/1.1 Host: vulnerable-website.com 
Cookie: account=victim-user 
... 

verification-code=123456
```

An attacker can then bruteforce this verification code and log in into the account without having access to their password.

## Brute-forcing 2FA verification codes
Some websites attempt to prevent this by automatically logging a user out if they enter a certain number of incorrect verification codes. This is ineffective in practice because an advanced attacker can automate this multi-step by using [[Turbo Intruder]].